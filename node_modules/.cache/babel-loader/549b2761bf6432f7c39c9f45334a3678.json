{"ast":null,"code":"import _objectSpread from \"/Users/isabel/Desktop/PlanNGo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/isabel/Desktop/PlanNGo/src/containers/spots/Spots.js\";\nimport React, { Component } from 'react';\nimport { Droppable } from 'react-beautiful-dnd';\nimport './../../App.css';\nimport PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/core/styles';\nimport AppBar from '@material-ui/core/AppBar';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport PhoneIcon from '@material-ui/icons/Phone';\nimport FavoriteIcon from '@material-ui/icons/Star';\nimport StarIcon from '@material-ui/icons/Star';\nimport RestaurantIcon from '@material-ui/icons/Restaurant';\nimport LocateIcon from '@material-ui/icons/LocationCity';\nimport Typography from '@material-ui/core/Typography';\nimport Paper from '@material-ui/core/Paper';\nimport Col from './SpotsCol';\nimport { Element, scrollSpy, Events, Link } from 'react-scroll';\nimport { DAYS_INFO, ITEM_SUBSCRIPTION, ITEMINFO_SUBSCRIPTION } from '../../graphql';\nimport { Query, Mutation } from 'react-apollo';\nimport { listToObjbyID } from '../../util';\nconst totalTypes = [\"droppable-1\", \"droppable-2\", \"droppable-3\"];\n\nfunction TabContainer(props) {\n  return React.createElement(Element, {\n    name: \"Container\",\n    className: \"element fixed-size\",\n    id: \"ContainerElement\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 26\n    },\n    __self: this\n  }, React.createElement(Typography, {\n    component: \"div\",\n    style: {\n      padding: 8\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 27\n    },\n    __self: this\n  }, props.children));\n}\n\nTabContainer.propTypes = {\n  children: PropTypes.node.isRequired\n};\n\nclass Spots extends Component {\n  constructor(props) {\n    super(props);\n\n    this.handleChange = (e, newValue) => [this.setState({\n      value: newValue\n    })];\n\n    this.handleDelete = (id, colid) => {\n      this.props.handleDelete(id, colid);\n    };\n\n    this.unsubscribe = null;\n    this.state = {\n      value: 0\n    };\n  }\n\n  render() {\n    const userID = this.props.user;\n    return React.createElement(Query, {\n      query: DAYS_INFO,\n      fetchPolicy: \"network-only\",\n      variables: {\n        userID\n      },\n      partialRefetch: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    }, ({\n      loading,\n      error,\n      data,\n      subscribeToMore\n    }) => {\n      if (error) return React.createElement(\"div\", {\n        id: \"middle_spot\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }, \"error!\");\n      if (loading) return React.createElement(\"div\", {\n        id: \"middle_spot\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 63\n        },\n        __self: this\n      }, \"loading...\");\n      const daysInfo = listToObjbyID(data.users.days);\n      console.log(\"DAYINFO\", daysInfo);\n      let renderCols = totalTypes.map(colId => {\n        const column = daysInfo[colId];\n        const items = column.items;\n        return React.createElement(Col, {\n          socket: this.props.socket,\n          user: userID,\n          key: column.id,\n          column: column,\n          items: items,\n          handleDelete: this.handleDelete,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 69\n          },\n          __self: this\n        });\n      });\n      let value = this.state.value;\n\n      if (!this.unsubscribe) {\n        this.unsubscribe = [subscribeToMore({\n          document: ITEM_SUBSCRIPTION,\n          variables: {\n            userid: userID,\n            id: userID\n          },\n          updateQuery: (prev, {\n            subscriptionData\n          }) => {\n            if (!subscriptionData.data) return prev;\n            const newDays = subscriptionData.data.item.data.days;\n            const newtotalDays = subscriptionData.data.item.data.totalDays;\n            const newfirstDay = subscriptionData.data.item.data.firstDay; // console.log(\"YAAAAAAAAAAAAAA\")            \n\n            prev.users.days = newDays;\n            prev.users.totalDays = newtotalDays; // prev.users.firstDay = newfirstDay;\n\n            return _objectSpread({}, prev, {\n              days: newDays,\n              totalDays: newtotalDays,\n              firstDay: newfirstDay\n            });\n          }\n        }), subscribeToMore({\n          document: ITEMINFO_SUBSCRIPTION,\n          variables: {\n            userid: userID\n          },\n          updateQuery: (prev, {\n            subscriptionData\n          }) => {\n            if (!subscriptionData.data) return prev;\n            const newItem = subscriptionData.data.iteminfo.data;\n            const updatedays = prev.users.days;\n            const updatedayindex = updatedays.findIndex(day => {\n              return day.items.find(item => {\n                return item.id === newItem.id;\n              });\n            });\n            const updateitemindex = updatedays[updatedayindex].items.findIndex(item => {\n              return item.id === newItem.id;\n            });\n            updatedays[updatedayindex].items[updateitemindex].place = newItem.place;\n            prev.users.days = updatedays;\n            return _objectSpread({}, prev, {\n              days: updatedays\n            });\n          }\n        })];\n      }\n\n      return React.createElement(\"div\", {\n        id: \"middle_spot\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, React.createElement(Paper, {\n        square: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, React.createElement(Tabs, {\n        value: value,\n        onChange: this.handleChange //variant=\"fullWidth\"\n        ,\n        indicatorColor: \"secondary\",\n        textColor: \"secondary\",\n        variant: \"scrollable\",\n        scrollButtons: \"auto\" // size=\"small\"\n        ,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, React.createElement(Tab, {\n        icon: React.createElement(RestaurantIcon, {\n          style: {\n            margin: \"9\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 143\n          },\n          __self: this\n        }),\n        style: {\n          padding: 4,\n          width: '33%',\n          minWidth: 90,\n          minHeight: 18\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }), React.createElement(Tab, {\n        icon: React.createElement(StarIcon, {\n          style: {\n            margin: \"9\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 144\n          },\n          __self: this\n        }),\n        style: {\n          padding: 4,\n          width: '33%',\n          minWidth: 90,\n          minHeight: 18\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }), React.createElement(Tab, {\n        icon: React.createElement(LocateIcon, {\n          style: {\n            margin: \"9\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }),\n        style: {\n          padding: 4,\n          width: '33%',\n          minWidth: 90,\n          minHeight: 18\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }))), value === 0 && React.createElement(TabContainer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, renderCols[0]), value === 1 && React.createElement(TabContainer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, renderCols[1]), value === 2 && React.createElement(TabContainer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, renderCols[2])));\n    });\n  }\n\n}\n\nexport default Spots;","map":{"version":3,"sources":["/Users/isabel/Desktop/PlanNGo/src/containers/spots/Spots.js"],"names":["React","Component","Droppable","PropTypes","makeStyles","AppBar","Tabs","Tab","PhoneIcon","FavoriteIcon","StarIcon","RestaurantIcon","LocateIcon","Typography","Paper","Col","Element","scrollSpy","Events","Link","DAYS_INFO","ITEM_SUBSCRIPTION","ITEMINFO_SUBSCRIPTION","Query","Mutation","listToObjbyID","totalTypes","TabContainer","props","padding","children","propTypes","node","isRequired","Spots","constructor","handleChange","e","newValue","setState","value","handleDelete","id","colid","unsubscribe","state","render","userID","user","loading","error","data","subscribeToMore","daysInfo","users","days","console","log","renderCols","map","colId","column","items","socket","document","variables","userid","updateQuery","prev","subscriptionData","newDays","item","newtotalDays","totalDays","newfirstDay","firstDay","newItem","iteminfo","updatedays","updatedayindex","findIndex","day","find","updateitemindex","place","margin","width","minWidth","minHeight"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Droppable } from 'react-beautiful-dnd';\nimport './../../App.css';\nimport PropTypes from 'prop-types';\nimport { makeStyles } from '@material-ui/core/styles';\nimport AppBar from '@material-ui/core/AppBar';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport PhoneIcon from '@material-ui/icons/Phone';\nimport FavoriteIcon from '@material-ui/icons/Star';\nimport StarIcon from '@material-ui/icons/Star';\nimport RestaurantIcon from '@material-ui/icons/Restaurant';\nimport LocateIcon from '@material-ui/icons/LocationCity';\nimport Typography from '@material-ui/core/Typography';\nimport Paper from '@material-ui/core/Paper';\nimport Col from './SpotsCol'\nimport { Element, scrollSpy, Events, Link } from 'react-scroll';\nimport { DAYS_INFO, ITEM_SUBSCRIPTION, ITEMINFO_SUBSCRIPTION} from '../../graphql'\nimport { Query, Mutation } from 'react-apollo'\nimport { listToObjbyID } from '../../util'\n\nconst totalTypes = [\"droppable-1\", \"droppable-2\", \"droppable-3\"]\n\nfunction TabContainer(props) {\n  return (\n    <Element name=\"Container\" className=\"element fixed-size\" id=\"ContainerElement\">\n      <Typography component=\"div\" style={{ padding: 8 }}>\n        {props.children}\n      </Typography>\n    </Element>\n  );\n}\n\nTabContainer.propTypes = {\n  children: PropTypes.node.isRequired,\n};\n\n\nclass Spots extends Component {\n  constructor(props){\n    super(props);\n    this.state ={\n      value:0\n    }\n  }\n  \n  handleChange = (e, newValue) => [\n    this.setState({\n      value: newValue\n    })\n  ]\n  handleDelete = (id, colid) => {\n    this.props.handleDelete(id, colid)\n  }\n\n  unsubscribe = null\n\n  render() {\n    const userID = this.props.user\n    return (<Query query={DAYS_INFO} fetchPolicy='network-only' variables={{userID}} partialRefetch={true}>{\n      ({loading, error, data, subscribeToMore}) => {\n        if (error) return <div id=\"middle_spot\">error!</div>\n        if (loading) return <div id=\"middle_spot\">loading...</div>\n        const daysInfo = listToObjbyID(data.users.days)\n        console.log(\"DAYINFO\",daysInfo)\n        let renderCols = totalTypes.map(colId => {\n          const column = daysInfo[colId];\n          const items = column.items;\n          return (<Col socket={this.props.socket} user={userID} key={column.id} column={column} items={items} handleDelete={this.handleDelete}/>);\n        })\n\n        let value = this.state.value;\n        if (!this.unsubscribe) {\n          this.unsubscribe = [ \n            subscribeToMore({\n              document:  ITEM_SUBSCRIPTION,\n              variables: { userid: userID, id: userID },\n              updateQuery: (prev, { subscriptionData }) => {\n               \n                if (!subscriptionData.data) return prev\n                const newDays = subscriptionData.data.item.data.days;\n                const newtotalDays = subscriptionData.data.item.data.totalDays;\n                const newfirstDay = subscriptionData.data.item.data.firstDay; \n                // console.log(\"YAAAAAAAAAAAAAA\")            \n                prev.users.days = newDays;\n                prev.users.totalDays = newtotalDays;\n                // prev.users.firstDay = newfirstDay;\n                \n                return {\n                  ...prev,\n                  days: newDays,\n                  totalDays: newtotalDays,\n                  firstDay: newfirstDay\n                }\n            }}),\n        subscribeToMore({\n          document: ITEMINFO_SUBSCRIPTION,\n          variables: { userid: userID },\n          updateQuery: (prev, { subscriptionData }) => {\n         \n            if (!subscriptionData.data) return prev\n            const newItem = subscriptionData.data.iteminfo.data\n            \n            const updatedays = prev.users.days\n            const updatedayindex = updatedays.findIndex(day => {\n              return day.items.find(item => {\n                return item.id === newItem.id\n              })\n            })\n            const updateitemindex = updatedays[updatedayindex].items.findIndex(item => {\n              return item.id === newItem.id\n            })\n            updatedays[updatedayindex].items[updateitemindex].place = newItem.place\n            prev.users.days = updatedays\n\n            return {\n              ...prev,\n              days: updatedays\n            }\n          }\n      })]\n        }\n        return(\n          <div id=\"middle_spot\">\n            {/* <span>\n              <Typography variant=\"h5\" gutterBottom style={{marginLeft:'10px', marginTop:'10px'}}>\n                Spots\n              </Typography>\n            </span> */}\n            <div>\n              {/* <AppBar position=\"static\" color=\"default\"> */}\n              <Paper square >\n                <Tabs\n                  value={value}\n                  onChange={this.handleChange}\n                  //variant=\"fullWidth\"\n                  indicatorColor=\"secondary\"\n                  textColor=\"secondary\"\n                  variant=\"scrollable\"\n                  scrollButtons=\"auto\"\n                  // size=\"small\"\n                >\n                  <Tab  icon={<RestaurantIcon style={{margin: \"9\"}}/> } style={{ padding: 4, width:'33%', minWidth: 90, minHeight: 18 }} />\n                  <Tab  icon={<StarIcon style={{margin: \"9\"}}/>} style={{ padding: 4, width:'33%', minWidth: 90, minHeight: 18 }} />\n                  <Tab  icon={<LocateIcon style={{margin: \"9\"}}/>} style={{ padding: 4, width:'33%', minWidth: 90, minHeight: 18 }} />\n                </Tabs>\n              </Paper>\n              {value === 0 && <TabContainer>{renderCols[0]}</TabContainer>}\n              {value === 1 && <TabContainer>{renderCols[1]}</TabContainer>}\n              {value === 2 && <TabContainer>{renderCols[2]}</TabContainer>}\n            </div>\n          </div>\n        );\n      }\n    }</Query>);\n  }\n}\n\nexport default Spots;"]},"metadata":{},"sourceType":"module"}